#!/bin/bash

emacs='/usr/bin/emacs --geometry 120x60'

if [ "$1" = '-kill' ]; then
  exec emacsclient -e '(spacemacs/kill-emacs)'
elif [ "$1" = '-ns' ]; then
  shift
  export EMACS_SERVER="disabled"
elif [ -S "/tmp/emacs$UID/server" ]; then
  emacs='emacsclient --create-frame'
elif [ -z "$DISPLAY" -o -n "$SSH_CONNECTION" ]; then
  unset DISPLAY
fi

if [ -n "$DISPLAY" ] && ! [[ "$*" =~ -nw|-t|--tty ]]; then
  eval $emacs "$@" &>/dev/null &
else
  eval exec $emacs "$@"
fi
