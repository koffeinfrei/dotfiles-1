#!/bin/bash

emacs='emacsclient -c'

if [ "$1" = '-kill' ]; then
  exec emacsclient -e '(kill-emacs)'
elif [ "$1" = '-ns' ]; then
  shift
  emacs='emacs --geometry 120x60'
elif ! pgrep -fx 'emacs --daemon' >/dev/null; then
  emacs --daemon &>/dev/null
fi

if [ -n "$DISPLAY" ] && ! [[ "$*" =~ -nw|--no-window-system ]]; then
  $emacs "$@" &>/dev/null &
else
  exec $emacs "$@"
fi
