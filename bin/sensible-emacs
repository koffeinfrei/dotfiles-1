#!/bin/bash

emacs='emacsclient -c -a ""'

if [ "$1" = '-kill' ]; then
  exec emacsclient -e '(kill-emacs)'
elif [ "$1" = '-ns' ]; then
  shift
  emacs='emacs --geometry 120x60'
elif [ -z "$DISPLAY" -o -n "$SSH_CONNECTION" ]; then
  unset DISPLAY
  emacs='emacs'
fi

if [ -n "$DISPLAY" ] && ! [[ "$*" =~ -nw|--no-window-system ]]; then
  eval $emacs "$@" &>/dev/null &
else
  eval exec $emacs "$@"
fi
