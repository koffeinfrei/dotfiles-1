#!/bin/bash

if [ -n "$1" ] && [ "$1" != "!" ]; then
  exec sensible-editor "$@"
fi

files=$( git -c color.ui=always status -s | sort -rk2 )

if [ "$1" != "!" ] && [ "$( echo "$files" | wc -l )" -gt 1 ]; then
  files=$( echo "$files" | fzf )
fi

if [ -n "$files" ]; then
  sensible-editor $( echo "$files" | sed -r 's/.* //' )
fi
